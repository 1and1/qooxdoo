// generic application.json
{
  "name"    : "generic application.json",

  "include" :
  [
    {
      "path" : "../../../application/apiviewer/config.json",
      "as"   : "apiconf"
    }
  ],

  "export" : 
  [
    "api",
    "build",
    "clean",
    "distclean",
    "lint",
    "pretty",
    "source",
    "translate"
  ],

        

  "let" :
  {
    "ROOT"         : ".",
    "QOOXDOO_PATH" : "../../framework",
    "QOOXDOO_URI"  : "../${QOOXDOO_PATH}",
    "CACHE"        : "cache",
    "QXTHEME"      : "qx.theme.Classic",
    "LOCALES"      : [ "en" ],
    "BUILD_PATH"   : "${ROOT}/build"
  },

  "jobs" :
  {
    "common" :
    {
      "library" :
      [
        {
          "manifest" : "${QOOXDOO_PATH}/Manifest.json",
          "uri"      : "${QOOXDOO_URI}"
        },

        {
          "manifest" : "${ROOT}/Manifest.json",
          "uri"      : ".."
        }
      ],

      "include" :
      [
        "${APPLICATION}.Application",
        "${QXTHEME}"
      ],

      "cache" :
      {
        "path" :  "${CACHE}"
      },

      "localize" :
      {
        "locales" : "${LOCALES}"
      },

      "settings" :
      {
        "qx.version"     : "0.8-alpha1",
        "qx.theme"       : "${QXTHEME}",
        "qx.application" : "${APPLICATION}.Application"
      }
    },


    "source-script" :
    {
      "extend" : ["common"],

      "compile-source" :
      {
        "file" : "${ROOT}/source/script/${APPLICATION}.js",
        "root" : "source"
      }
    },


    "source" :
    {
      "run" :
      [
        "source-script"
      ]
    },


    "build-script" :
    {
      "extend" : ["common"],

      "variants" :
      {
        "qx.debug" : ["off"]
      },

      "compile-dist" :
      {
        "target" : "${BUILD_PATH}",
        "file" : "${BUILD_PATH}/script/${APPLICATION}.js",
        "uri"  : "script/${APPLICATION}.js",
        "root" : "${BUILD_PATH}",
        "format" : "on",
        "optimize" : ["basecalls", "variables", "privates", "strings"]
      }
    },


    "build-files" :
    {
      "extend" : ["common"],

      "copy-files" :
      {
        "files" :
        [
          "index.html"
        ],

        "target" : "${BUILD_PATH}"
      }
    },


    "build-resources":
    {
      "extend" : ["common"],

      "copy-resources" :
      {
        "target"          : "${BUILD_PATH}",
        "resource-filter" : true
      }
    },


    "build" :
    {
      "run" :
      [
        "build-resources",
        "build-script",
        "build-files"
      ]
    },


    "translate" :
    {
      "extend" : ["common"],

      "translation" :
      {
        "update" : ["${APPLICATION}"]
      }
    },    
    
    
    // can be used as an 'extend' to activate profiling
    "profiling" :
    {
      "variants" :
      {
        "qx.aspects" : ["on"]
      },

      "require" :
      {
        "qx.Class" : [ "qx.core.Aspect", "qx.dev.Profile" ]
      }
    },
    
    
    "pretty" :
    {
      "cache" : 
      { 
        "path" : "${CACHE}" 
      }, 

      "include" : [ "=${APPLICATION}.*" ],

      "library" : 
      [ 
        { 
          "manifest" : "${ROOT}/Manifest.json",
          "uri"      : ".."
        }
      ],

      "pretty-print" : {}
    },


    "clean" :
    {
      "clean-files" :
      {
        "Cleaning up build" :
        [
          "${BUILD_PATH}/script/${APPLICATION}.js",
          "${BUILD_PATH}/script/${APPLICATION}[_-]*.js"
        ],
        "Cleaning up source" :
        [
          "${ROOT}/cache",
          "${ROOT}/source/script/${APPLICATION}.js",
          "${ROOT}/source/translation/messages.pot"
        ],
        "Cleaning up framework" :
        [
          "${QOOXDOO_PATH}/source/translation/messages.pot"
        ]
      }
    },


    "distclean" :
    {
      "clean-files" : 
      {
        "Deleting build" :
        [
          "${BUILD_PATH}"
        ],
        "Deleting api" :
        [
          "${ROOT}/api"
        ],
        "Deleting debug" :
        [
        ],
        "Deleting AIR application" :
        [
        ],
        "Deleting buildtool" :
        [
          "${ROOT}/tool/buildtool"
        ],
        "Deleting test" :
        [
          "${ROOT}/test"
        ],
        "Cleaning up source" :
        [
          "${ROOT}/source/script",
          "${ROOT}/source/class/${APPLICATION}/translation",
          "${ROOT}/source/translation/messages.pot"
        ],
        "Cleaning up framework" :
        [
          "${CACHE}",
          "${QOOXDOO_PATH}/.cache",
          "${QOOXDOO_PATH}/source/translation/messages.pot",
          "${QOOXDOO_PATH}/source/class/qx/locale/data",
          "${QOOXDOO_PATH}/source/class/qx/locale/translation"
        ]
      }
    },


    "lint" :
    {
      "cache" : 
      { 
        "path" : "${CACHE}" 
      }, 

      "library" : 
      [ 
        { 
          "manifest" : "${ROOT}/Manifest.json",
          "uri"      : ".."
        }
      ],

      "lint-check" :
      {
        "allowed-globals" : [ "qx", "qxsettings", "qxvariants", "${APPLICATION}" ]
      }
    },


    "api" :
    {
      "extend" : ["apiconf::build"],

      "let" :
      {
        "APIVIEWER_ROOT" : "${QOOXDOO_PATH}/../application/apiviewer",
        "BUILD_PATH" : "./api",
        "API_INCLUDE" : ["qx.*", "${APPLICATION}.*"]
      },

      "library" :
      [
        {
          "manifest" : "Manifest.json",
          "uri"      : ".."
        }
      ]
    }
  }
}

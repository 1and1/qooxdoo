<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>qooxdoo &raquo; Demo</title>
  <link type="text/css" rel="stylesheet" href="../../resource/css/layout.css"/>
  <!--[if IE]>
  <link type="text/css" rel="stylesheet" href="../../resource/css/layout_ie.css"/>
  <![endif]-->
  <script type="text/javascript" src="../../script/qx.js"></script>

	<style type="text/css">
	#keylogger {
		position: absolute;
		width: 500px;
		height: 500px;
		left: 30px;
		top: 40px;
		color: black;
		background-color: #EEE;
		padding: 5px;
		border: 1px inset;
		overflow: scroll;
		/* display:none; */
	}
	
	table {
		width: 100%;
	}
	
	td {
		text-align: center;
	}
	</style>
	
</head>
<body>
  <script type="text/javascript" src="../../script/layout.js"></script>

  <div id="demoDescription">
    <p>Keyhandler Test</p>
		<p>Displays qoooxdoo's normalized key events.</p>
  </div>

  
	<div id="keylogger">
		<table>
			<tr><th>Event</th><th>key identifier</th><th>key code</th><th>char code</th><th>Shift</th><th>Ctrl</th><th>Alt</th></tr>
		</table>
	</div>
	
	<script type="text/javascript">

		var keyEvents = [];
		var maxLogSize = 50;
		var d = qx.ui.core.ClientDocument.getInstance();
			
		function logKeyEvent2(keyEvent) {
			var eventCopy = {
				type: keyEvent.getType(),
				iden: keyEvent.getKeyIdentifier(),
				keyCode: keyEvent.getKeyCode(),
				charCode: keyEvent.getCharCode(),
				shift: keyEvent.getDomEvent().shiftKey,
				alt: keyEvent.getDomEvent().altKey,
				ctrl: keyEvent.getDomEvent().ctrlKey				
			}
			keyEvents.unshift(eventCopy);
			keyEvents = keyEvents.slice(0, maxLogSize);
			str = ["<table>"];
			str.push("<tr><th>Event</th><th>key identifier</th><th>key code</th><th>char code</th><th>Shift</th><th>Ctrl</th><th>Alt</th></tr>");
			for (var i=0; i<keyEvents.length; i++) {
				var e = keyEvents[i];
				str.push("<tr><td>");
				str.push(e.type);
				str.push("</td><td>");
				str.push(e.iden);
				str.push("</td><td>");
				str.push(e.keyCode);
				str.push("</td><td>");
				str.push(e.charCode);
				str.push("</td><td>");
				str.push(e.shift);
				str.push("</td><td>");
				str.push(e.ctrl);
				str.push("</td><td>");
				str.push(e.alt);
				str.push("</td></tr>");
			}
			str.push("</table>");
			document.getElementById("keylogger").innerHTML = str.join("");
			document.getElementById("keylogger").scrollTop = 0;
		}
				
		d.addEventListener(qx.constant.Event.KEYDOWN, logKeyEvent2);
		d.addEventListener(qx.constant.Event.KEYPRESS, logKeyEvent2);
		d.addEventListener("keyinput", logKeyEvent2);
		d.addEventListener(qx.constant.Event.KEYUP, logKeyEvent2);
		</script>
</body>
</html>

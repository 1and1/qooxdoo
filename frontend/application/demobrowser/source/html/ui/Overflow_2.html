<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>qooxdoo &raquo; Demo Browser</title>
  <script type="text/javascript">
    qxsettings = {
      "qx.enableApplicationLayout" : false,
      "qx.boxModelCorrection" : false
    };
  </script>
  <script type="text/javascript" src="../../script/demo.js"></script>
  <script type="text/javascript" src="../util.js"></script>
  <style type="text/css">
    body {
      font: 11px Tahoma, sans-serif;
    }
  </style>
</head>
<body>
  <div id="description">
  </div>

  <script type="text/javascript">

qx.Class.define("ScrollArea",
{
  extend : qx.ui2.core.Widget,

  construct : function()
  {
    this.base(arguments);

    this.set({
      backgroundColor: "yellow"
    })

    var layout = new qx.ui2.layout.HBox();
    this.setLayout(layout);

    this._lButton = new qx.ui2.core.Label("<").set({
      backgroundColor : "gray",
      visibility :"exclude"
    });

    this._rButton = new qx.ui2.core.Label(">").set({
      backgroundColor : "gray",
      visibility : "exclude"
    });

    this._lButton.addListener("click", this._scrollRight, this);
    this._rButton.addListener("click", this._scrollLeft, this);

    this._pane = new qx.ui2.core.Widget();
    this._pane.setLayout(new qx.ui2.layout.Basic());
    this._pane.addListener("resize", this._onResize, this);

    layout.add(this._lButton);
    layout.add(this._pane, {flex: 1});
    layout.add(this._rButton);
  },

  members :
  {
    setContent : function(content)
    {
      var layout = this._pane.getLayout();
      layout.add(content, 0, 0);
      this._content = content;

      content.addListener("resize", this._onResize, this);
    },

    _onResize : function(e)
    {
      var paneSize = this.getComputedLayout();
      var contentSize = this._content.getComputedLayout();

      if (contentSize.width > paneSize.width) {
        this._showArrows();
      } else {
        this._hideArrows();
      }
    },

    _showArrows: function()
    {
      this._lButton.setVisibility("show");
      this._rButton.setVisibility("show");
    },

    _hideArrows: function()
    {
      this._lButton.setVisibility("exclude");
      this._rButton.setVisibility("exclude");
      this._pane._contentElement.setAttribute("scrollLeft", 0);
    },

    _scrollLeft : function()
    {

      var old = this._pane._contentElement.getAttribute("scrollLeft");
      this._pane._contentElement.setAttribute("scrollLeft", old + 10, true);
    },

    _scrollRight : function()
    {
      var old = this._pane._contentElement.getAttribute("scrollLeft");
      this._pane._contentElement.setAttribute("scrollLeft", old - 10, true);
    }

  }
})

qx.Class.define("BasicSample",
{
  extend : qx.application.Gui2,

  members :
  {
    main : function()
    {
      this.base(arguments);

      doc = new qx.ui2.root.Application(document);
      doc.setTextColor("black");
      doc.setBackgroundColor("white");

      scrollArea = new ScrollArea();
      scrollArea.set({
        width: 500
      });

      scrollArea.setContent(this.getContent());

      var toggle = new qx.ui2.core.Label("Toggle size").set({
        padding : 5,
        backgroundColor: "orange"
      });

      var grow = true;
      toggle.addListener("click", function()
      {
        scrollArea.setWidth(grow ? 800 : 500);
        grow = !grow;
      });

      doc.add(toggle, 10, 80);

      doc.add(scrollArea, 10, 10);
    },

    getContent : function()
    {
      var box = new qx.ui2.core.Widget();
      var layout = new qx.ui2.layout.HBox();

      for (var i=0; i<10; i++)
      {
        layout.add((new qx.ui2.core.Widget()).set({
          backgroundColor : (i % 2 == 0) ? "red" : "blue",
          width : 60,
          height: 20
        }));
      }
      box.setLayout(layout);
      return box;
    }


  }
});

qx.core.Init.getInstance().setApplication(new BasicSample);
  </script>
</body>
</html>

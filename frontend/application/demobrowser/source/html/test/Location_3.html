<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>qooxdoo &raquo; Demo Browser</title>
  <script type="text/javascript">
  qxsettings = {
    "qx.enableApplicationLayout" : false
  };
  </script>
  <script type="text/javascript" src="../../script/demo.js"></script>
  <script type="text/javascript" src="../util.js"></script>
</head>
<body>
  <script type="text/javascript">
    function jump(event)
    {
      if (!event) {
        event = window.event;
      }

      event.returnValue = false;

      if (event.preventDefault) {
        event.preventDefault();
      }

    	var href = this.href;
    	var id = href.substr(href.indexOf('#')+1);

    	var frame1 = document.getElementById("inner1");
    	var doc1 = qx.html.Iframe.getDocument(frame1);
    	var elem1 = doc1.getElementById(id);

    	var frame2 = document.getElementById("inner2");
    	var doc2 = qx.html.Iframe.getDocument(frame2);
    	var elem2 = doc2.getElementById(id);

    	var location1 = qx.html2.Location.get(elem1, document.getElementById("mode").value);
    	var location2 = qx.html2.Location.get(elem2, document.getElementById("mode").value);

    	//console.log("Location 1: " + location1.left + "x" + location1.top);
    	//console.log("Location 2: " + location2.left + "x" + location2.top);

    	doc1.getElementById("moveable").style.left = location1.left + "px";
    	doc1.getElementById("moveable").style.top = location1.top + "px";

    	doc2.getElementById("moveable").style.left = location2.left + "px";
    	doc2.getElementById("moveable").style.top = location2.top + "px";

    	return false;
    }

    function randomize()
    {
    	var frame1 = document.getElementById("inner1");
    	var doc1 = qx.html.Iframe.getDocument(frame1);

    	var frame2 = document.getElementById("inner2");
    	var doc2 = qx.html.Iframe.getDocument(frame2);

      var divs1 = qx.lang.Array.fromCollection(doc1.body.getElementsByTagName("div"));
      var divs2 = qx.lang.Array.fromCollection(doc2.body.getElementsByTagName("div"));

      var divs = [];
      qx.lang.Array.append(divs, divs1);
      qx.lang.Array.append(divs, divs2);

      for (var i=0, l=divs.length; i<l; i++)
      {
        if (divs[i].id && divs[i].id != "moveable")
        {
          divs[i].style.margin = Math.round(Math.random()*10) + "px";
          divs[i].style.padding = Math.round(Math.random()*10) + "px";
          divs[i].style.borderWidth = Math.round(Math.random()*10) + "px";
        }
      }
    }

    qx.Class.define("BasicSample",
    {
      extend : qx.application.Basic,

      members :
      {
        main : function()
        {
          this.base(arguments);

      		var links = document.getElementById("list").getElementsByTagName("a");
      	  for (var i=0, l=links.length; i<l; i++) {
            links[i].onclick = jump;
      	  }
        }
      }
    });

    qx.core.Init.getInstance().setApplication(new BasicSample);
  </script>

	<p>
	  Select a div to move the grey box too. First frame used quirks mode. Second uses standard mode.
  	<select id="mode">
  	  <option value="margin">margin</option>
  	  <option value="box" selected="selected">box</option>
  	  <option value="border">border</option>
  	  <option value="content">content</option>
  	</select>
  	<a href="javascript:randomize()">Randomize</a>
	</p>

	<ul id="list">
		<li><a href="#static">Move to static 1</a></li>
		<li><a href="#staticChild1">Move to static child 1</a></li>
		<li><a href="#staticChild2">Move to static child 2</a></li>
		<li><a href="#relative">Move to relative 1</a></li>
		<li><a href="#relativeChild1">Move to relative child 1</a></li>
		<li><a href="#relativeChild2">Move to relative child 2</a></li>
		<li><a href="#absolute">Move to absolute 1</a></li>
		<li><a href="#absoluteChild1">Move to absolute child 1</a></li>
		<li><a href="#absoluteChild2">Move to absolute child 2</a></li>
		<li><a href="#absolute2">Move to absolute 2</a></li>
		<li><a href="#relative2">Move to relative 2</a></li>
		<li><a href="#static2">Move to static 2</a></li>
		<li><a href="#relative3">Move to relative 3</a></li>
		<li><a href="#absolute3">Move to absolute 3</a></li>
		<li><a href="#static3">Move to static 3</a></li>
		<li><a href="#inline">Move to inline 1</a></li>
	</ul>

	<iframe id="inner1" style="width:800px; height:400px; overflow:auto" src="Location_3_frame.html"></iframe>
	<br/>
	<iframe id="inner2" style="width:800px; height:400px; overflow:auto" src="Location_3_frame_std.html"></iframe>
</body>
</html>
